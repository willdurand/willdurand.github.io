---
layout: post
title: Introducing xpidump
location: Clermont-Fd Area, France
image: /images/posts/2024/04/xpidump-social.webp
tags: [mozilla, engineering]
mastodon_id: 112233710424881107
---

I wrote _xpidump_ to give a human-readable summary of some information about a
[Firefox add-on][]. It is designed to answer these two questions: is the add-on
likely[^1] signed? And if so, how?

[^1]: This tool doesn't verify the signature, so it cannot guarantee that the
      add-on is correctly signed.

This tool takes an XPI file as input. XPI files are Firefox add-ons packaged
as ZIP archives with the `.xpi` file extension. _xpidump_ currently extracts
information from up to 4 files in an XPI (depending on what is available in the
archive):

- `manifest.json`: this JSON file defines the add-on. It is required in any
  add-on (packaged or not, signed or not).
- `META-INF/mozilla.rsa`: this binary file is a [PKCS#7][] signature. Any signed
  add-on should have this file (in addition to `META-INF/mozilla.sf` and
  `META-INF/manifest.mf` but _xpidump_ doesn't read them).
- `META-INF/cose.sig`: this binary file is a [COSE][] signature[^2]. It might
  not be present when the add-on isn't signed or relatively old[^3]. There
  should also be a `META-INF/cose.manifest` file when this file exists.
- `mozilla-recommendation.json`: this JSON file is generated by Mozilla's
  signing service [Autograph][] when an add-on is signed with recommendation
  states. This is how Firefox knows that an add-on is [recommended][] for
  instance. It might or might not be present.

[^2]: Well, a COSE sign message with a signature and serialized with [CBOR][],
      though we should probably refer to the protocol as COSEish because of
      [this issue](https://github.com/franziskuskiefer/cose-rust/issues/60).

[^3]: Mozilla started to dual-sign add-ons in 2019.

_xpidump_ is both a command-line tool and a web app since the latter is usually
more convenient (no need to install anything). It's written in Rust, and
compiled to WebAssembly for the web app. You can try it at:
[williamdurand.fr/xpidump/](https://williamdurand.fr/xpidump/).

![](/images/posts/2024/04/xpidump.webp)
_xpidump is available in the browser thanks to WebAssembly!_
{:.with-caption}

The code is published on GitHub under the MIT license, see:
[willdurand/xpidump](https://github.com/willdurand/xpidump/). I don't have any
more plans for this weekend-ish project, it's doing what I wanted it to be
doing... Let me know if you have ideas, though.

One more thing while we're here... If you want a tool to read the entire content
of any XPI file and get tons of information, you want to use [CRX Viewer][]
created by my brilliant colleague Rob!

[autograph]: https://github.com/mozilla-services/autograph
[cbor]: https://datatracker.ietf.org/doc/html/rfc7049
[cose]: https://datatracker.ietf.org/doc/html/rfc8152
[crx viewer]: https://robwu.nl/crxviewer/
[firefox add-on]: https://addons.mozilla.org/firefox/
[pkcs#7]: https://tools.ietf.org/html/rfc2315
[recommended]: https://support.mozilla.org/en-US/kb/recommended-extensions-program
